[["index.html", "Développement doutils danalyses pour les données de PTR-ToF-MS Remerciements", " Développement doutils danalyses pour les données de PTR-ToF-MS Joris Huguenin 2021-08-31 Remerciements Je tenais à remercier Jean-Michel Roger et Nicolas Barthes qui ont bien voulu accepter dencadrer ce stage. Une chose me dit quon a pas fini de faire de la chimiométrie avec tous nos machin-MS. Pour continuer sur la chimiométrie, je remercie la team de Chemhouse et en particulier Silvia Mas-Garcia et Douglas Rutledge (et leur très léger accent respectif) pour leurs aides et conseils. Je salue également les autres membres de la PACE : Anne-Genevieve, Raphaelle, Bruno, Patrick et Benoit ; pour la sympathie au quotidien. Il en va de même pour tous les membres du CEFE1 avec qui je travaille régulièrement ou avec qui je partage des moments chaleureux. Mes pensées vont plus précisément vers Magalie, Candice, Cao Li et Anjélica. Ce rapport conclu un semestre de stage mais également une année de formation continue. Avant septembre 2020, mes dernières heures de cours en tant quétudiant dataient de décembre 2011. Depuis cette date, jai moi-même enseigné en tant que vacataire à lIUT durant mes années de thèses. Puis après dautres contrats, jai été embauché à lUniversité de Montpellier comme ingénieur. Ainsi en septembre 2020, jétais tout à la fois néo et ancien étudiant, camarade et collègue. Pour moi qui nétait que de passage, la difficulté des cours à distance ma affecté mais ne remettait pas en cause ni mon métier principal ni mon cursus universitaire. Pour autant je félicite leffort des professeurs qui ont su sadapter avec le peu de moyen mis à leur disposition. Je salue tout autant les étudiants en formation initiale qui jouent leur avenir professionnel. Enfin, je remercie les copains qui mont soutenu pendant lannée. Je déconseille vivement daccumuler reprise détude + travail + confinement/couvre feu + concours de la fonction publique + travaux de rénovation. Cest trop. En particuliers, merci à Ryad, Jean-Michel et Nicolas (encore eux) pour leur aide lors des concours et à Bruce Dickinson, Steve Harris et les autres pour mavoir accompagné durant lécriture des multiples rapports. Merci aussi à ceux qui mont ajouté du travail durant cette année : Ngoc qui fut une brillante élève de conduite supervisée et qui na failli nous tuer que deux fois, à Batro pour avoir eu la brillante idée de synchroniser la date de sortie de notre jeu(Artho et Batro 2020) avec la date du deuxième confinement, et aux créatures de la nuit quil faut nourrir didées nouvelles chaque semaine. Enfin merci à Hélène pour me supporter depuis tout ce temps, pour son soutien et pour son aide. References "],["glossaire.html", "Glossaire", " Glossaire AUC : Area Under the Curve. Calcul de lair sous la courbe. CEFE (UMR 5175) : Centre dÉcologie Fonctionnelle et Évolutive. Laboratoire daccueil situé sur le site de la DR13 du CNRS, route de Mende à Montpellier. COV (ou VOC) : Composé Organique Volatil. Molécule produite par des systèmes biologiques et analysée par le PTR-ToF-MS. Gaz zéro : gaz purifié grâce à un filtre à charbon. GC-MS : Gaz Chromatography Mass Spectroscopy. Autre méthode danalyse des COV, moins sensible mais plus discriminante que la PTR-ToF-MS. ICA : Independent Component Analysis. Méthode de calcul permettant de séparer les sources indépendantes. JADE : Joint Approximation Diagonalization of Eigen-matrices. Algorithme itératif utilisant le principe de lICA MCR-ALS : Multivariate Curve Resolution - Alternating Least Squares. Méthode de calcul permettant de retrouver les spectres pures. PACE : Plateforme dAnalyse Chimique en Écologie. Plateforme située au sein de lUMR 5175. PCA : Principal Component Analysis (ou ACP). Algorithme utilisé pour faire ressortir la variabilité entre les échantillons. PTR-ToF-MS : Proton Transfert Reaction Time of Flight Mass Spectroscopy. Acronyme utilisé pour linstrument de mesure (le PTR-ToF-MSpectrometer) et pour la méthode danalyse (la PTR-ToF-MSpectroscopy). Par abus de langage, lacronyme PTR-MS est régulièrement utilisé à loral. "],["introduction-générale.html", "Introduction générale", " Introduction générale À linstar de lannée 2021, ce stage de M2 a été un peu particulier. Lors de lélaboration du sujet en janvier, nous avons proposé un sujet résolument tourné vers lanalyse de données. Il sest avéré que mon temps de stage sest réparti différemment. Le sujet du stage a évolué afin de mieux couvrir lensemble du travail effectué durant ces mois. Le chapitre 1 rend compte de ces aspects en détaillant le contexte de ce stage, louverture qui a été amorcée afin de rendre compatible le travail de la plateforme avec les orientations publiques vers la science ouverte et de la relation entre les analystes et les praticiens. Le chapitre 2 est dédié à linstrument de mesure principalement utilisé lors du stage. Le PTR-ToF-MS analyse les molécules volatiles. Après une présentation de cette technique et de notre appareil, je détaillerais les données récupérées ainsi que le package R que jai écrit pour procéder à lanalyse. Nous ferons un comparatif entre cette technique et la GC-MS qui est régulièrement utilisée en parallèle. Enfin, le chapitre 3 détaille les opérations mathématiques utilisées pour lanalyse des données. Je développerai les choix faits quant aux prétraitements et à lalignement des spectres. Je présenterai également les algorithmes implémentés dans le package, en particulier celui de la MCR-ALS. Avant lintroduction se trouve un glossaire des termes techniques et des acronymes. À la fin de ce rapport, je livre une conclusion générale sur ce stage ainsi que sur le travail quil reste à accomplir. Un soin particulier a été apporté à la découpe des chapitres. Bien que la mode des rapports et articles scientifiques soit au storytelling, les trois chapitres suivant peuvent se lire dans lordre dintérêt du lecteur. "],["chap1.html", "1 Le métier dingénieur de plateforme 1.1 Contexte 1.2 Science ouverte 1.3 Plan dexpérience en écologie chimique 1.4 Conclusion partielle", " 1 Le métier dingénieur de plateforme 1.1 Contexte Depuis le 04 novembre 2019, joccupe un poste dingénieur affecté à la Plateforme dAnalyses Chimiques en Écologie (PACE). La PACE, créée en 2000, est spécialisée dans lanalyse chimique pour la communauté de recherche liée à lécologie, lenvironnement et la biodiversité. La PACE comporte six permanents et un CDD. Cette plateforme est un service mutualisé du LabEx CeMEB depuis 2011. Lunité de rattachement est le Centre dEcologie Fonctionnelle et Evolutive de Montpellier (CEFE UMR5175 du CNRS). Cette unité mixte possède quatre tutelles ; le CNRS, lUniversité de Montpellier (UM), lÉcole Pratique des Hautes Etudes (EPHE) et lInstitut de Recherche pour le Développement (IRD), ainsi que trois partenaires ; lUniversité Paul Valéry Montpellier 3 (UPVM3), SupAgro Montpellier et lINRAE. À ce titre, bien que rattachée au CEFE, la PACE accueille des projets de recherche issus des 12 unités du CeMEB (850 personnels permanents) mais aussi de toute la communauté académique nationale ou internationale. La PACE, à travers sa tutelle Université de Montpellier, a obtenu un financement GEPETOs dans le cadre du Contrat de Plan Etat-Région (CPER) 2015-2020 pour lachat dun spectromètre de masse en temps réel permettant datteindre des mesures de cinétique fine, même à létat de trace, abrégé en PTR-ToF-MS (Proton Transfert Reaction Time of Flight Mass Spectrometer) pour la PACE. Le chapitre 2 revient en détail sur cet instrument. Ce projet GEPETOs comporte une part dédiée au recrutement dun ingénieur détude devant bénéficier dune formation en double compétence de niveau Master 2. Avec mes responsables hiérarchiques, nous avons choisi le M2 SSV pour me permettre de renforcer mes connaissances statistiques. Le stage du second semestre sest donc effectué sur la plateforme PACE. Plusieurs étapes ont été définies pour lensemble du contrat : mise en place des procédures de recueil et de contrôle des données ; adaptation des méthodes danalyse mathématiques pour répondre aux besoins spécifiques du PTR-ToF-MS ; organisation de la mise en forme et du stockage des données ; assurer la maintenance des bases de données contenant les data produites par linstrument et les résultats des analyses. Il était prévu que le point 2 soit particulièrement mis en avant lors de ce stage. En réalité lensemble des points ci-dessus a été mobilisé. Cette introduction du contexte me permet de décrire létat desprit général lié à ce stage. Effectué sur mon lieu de travail, il y avait une dualité entre la nécessité dencadrer les utilisateurs de la platerforme et la possibilité offerte dun temps de réflexion et dexploration. La première modalité imposait le tempo, du pragmatisme et un calendrier à respecter. Ce printemps-été 2021 était particulièrement attendu pour deux raisons. Il fallait en quelque sorte rattraper le travail qui navait pu être effectué lors du confinement général du printemps 2020. De plus, les possibilités de lappareil commencent à être connues et celui-ci est beaucoup demandé. De plus, lintitulé initial de ce stage était \"Analyse descriptive des données PTR-ToF-MS des COV émis lors du cycle larvaire de la guêpe de lamande (Eurytoma amygdali). Je devais accompagner une doctorante dans son travail danalyse. Nous avons commencé les expériences dès février lors de la période de floraison des amandiers. Après deux mois dexpériences, la quantité de données recueillies était particulièrement importante. La doctorante avait débuté sa thèse en janvier mais le timing expérimental est imposé par la nature. Après le travail de terrain, elle a pu reprendre un rythme normal de thèse et effectuer le travail bibliographique nécessaire à tout projet scientifique. De mon coté, jai participé à la mise en place dautres expériences sur lesquelles nous reviendront dans ce rapport. Jai également pu prendre du recul sur mon activité et la repenser afin quelle cadre avec la politique actuelle de science ouverte. Ce stage ma ainsi permis de renforcer la partie de science reproductible des outils numériques que je conçois pour mes collègues chercheurs. 1.2 Science ouverte Durant cette période de stage, le gouvernement français a mis en place le Deuxième Plan pour la science ouverte qui définit les actions mises en place sur la période 2021-2024. Le plan est détaillé dans ce document dont je recommande vivement la lecture. Ce guide de route possède les défauts propres à lépoque2. Ceci étant, à léchelle de la communauté scientifique française, ce plan permet une large diffusion du savoir et de la culture scientifique grâce à des actions regroupées dans quatre axes : généraliser laccès ouvert aux publications; généraliser lobligation de publication en accès ouvert des articles et livres issus de recherches financées par des fonds publics; soutenir des modèles économiques dédition en accès ouvert sans frais de publication pour les auteurs; favoriser le multilinguisme3 et la circulation des savoirs scientifiques par la traduction des publications des chercheurs français; structurer, partager et ouvrir les données de la recherche; mettre en uvre lobligation de diffusion des données de recherche financées sur fonds publics; créer Recherche Data Gouv, la plateforme nationale fédérée des données de la recherche; promouvoir ladoption dune politique de données sur lensemble du cycle des données de la recherche, pour les rendre faciles à trouver, accessibles, interopérables et réutilisables (FAIR); ouvrir et promouvoir les codes sources produits par la recherche; valoriser et soutenir la diffusion sous licence libre des codes sources issus de recherches financées sur fonds publics; mettre en valeur la production des codes sources de lenseignement supérieur, de la recherche et de linnovation; définir et promouvoir une politique en matière de logiciels libres; transformer les pratiques pour faire de la science ouverte le principe par défaut. développer et valoriser les compétences de la science ouverte tout au long du parcours des étudiants et des personnels de la recherche; valoriser la science ouverte et la diversité des productions scientifiques dans lévaluation des chercheurs et enseignants-chercheurs, des projets et des établissements de recherche; tripler le budget de la science ouverte en sappuyant sur le Fonds national pour la science ouverte et le Programme dinvestissements davenir Les axes concernant le code et les données me concernent directement. Par mon travail, je produis des données ainsi que le code permettant lanalyse de celles-ci par mes collaborateurs. Le code est écrit en langage R sous la forme dun package, proVOC, déposé sur gitHub\\(\\circledR\\)4 . Il génère un workflow qui sauvegarde les paramètres et les données utilisées lors de lanalyse. Le dépôt sur un git permet louverture de ce code. Il est toutefois prévu deffectuer une migration sur gitLab afin de favoriser lutilisation des logiciels libres. Par ailleurs, je souhaite développer un module permettant de convertir les data brutes dans un format adapté à la futur plateforme Recherche Data Gouv. Ce module facilitera la production de data paper dont jai découvert lexistence au cours des journées casuHAL 2021. Grâce à deux demi-journées de formation sur Rmarkdown et sur la création de package, jai pu intégrer la génération de rapport automatisé dans le package5 qui est un premier pas vers lécriture automatisée des data paper.6 Jai également découvert et testé les packages et templates permettant de créer sous R un document découpé en chapitre. Jutilisais déjà Rmarkdown depuis un certains temps mais le passage à Bookdown et memoiR a demandé un temps dadaptation plus long que prévu. Ceci étant, ça na pas été en vain puisque jai eu plusieurs retours enthousiastes de collègues en vue dune formation sur ces packages. Jenvisage, une fois ce rapport terminé, de développer un clone de memoiR (avec laccord de lauteur) sur le style de EcoFoG afin de mettre à disposition aux membres du CEFE un templates clé en main. Ceci permettra de favoriser lécriture de rapport par des logiciels libres et daméliorer la reproductibilité de la science. 1.3 Plan dexpérience en écologie chimique Le chapitre suivant décrit la technique de la PTR-ToF-MS. Pour ce chapitre, nous avons juste besoin de savoir que cette technique analyse la cinétique démission des composés organiques volatils, COV, produits par léchantillon. Linstrument peut analyser séquentiellement plusieurs échantillons. Durant la période de stage, jai accompagné plusieurs séries dexpériences. Les modèles biologiques analysés varient à chaque expérience. Les plans dexpériences ont été conçus en dialoguant avec les utilisateurs. Bien souvent, ils avaient en tête lexpérience qui répondait le mieux possible à leur question biologique. Janticipais les incohérences techniques et joptimisais les paramètres de linstrument. Avec le recul, je me suis rendu compte que les connaissances acquisent en cours de recueil planifié de données nétaient pas pleinement exploitées. Sur ce type dinstrument, un des problèmes principaux est dû à la contamination de la ligne et de linstrument par léchantillon précédent. Nous pouvons analyser ces expériences pour repérer les erreurs commises. 1.3.1 Détection des traces dun complément alimentaire Cette expérience avait pour objectif de mesurer la diffusion de lodeur de nourriture (pour des poules) dans quatre sites dun mésocosme constitué de deux compartiments. La figure ?? illustre cette prise de mesure. Les sites étaient localisés dans la mangeoire (s1, compartiment 1, figure ??), au centre du compartiment 1 (s2), à la jonction des deux compartiments (s3, côté compartiment 2) et au fond du compartiment 2 (s4). La nourriture au sein de la mangeoire était soit de la nourriture témoin (T) soit dopée par de lhuile essentielle (A et B). Il y avait 5 mésocosmes pour chaque modalité. PTR-ToF-MS relié à lun des quatre sites de mesure dun mésocosme. Dans la théorie dune expérience totalement randomisée, il aurait fallu définir lordre aléatoire de chacune des 60 acquisitions7. Dans la pratique, cette expérience nécessitait de déplacer linstrument dun mésocosme à lautre entre chaque acquisition. Cette manipulation aurait drastiquement augmenter la durée de lexpérience. Nous avons donc tiré au hasard lordre de passage de chaque mésocosme, effectué un blanc et les acquisitions sur les quatre sites de mesures puis terminé par un nouveau blanc. Il aurait été juste de tirer au hasard lordre de passage des sites. Pour autant, nous avons opté pour une hypothèse forte de commencer par le site le plus éloigné de la mangeoire (s4, s3, s2, s1) et de remonter le gradient de diffusion. Dans les faits, nous laissions assez de temps entre deux mesures pour renouveler plusieurs fois le volume danalyse à lintérieur de linstrument ce qui permettait disoler les mesures. Après coup, je pense quil aurait été bon de procéder malgré tout à une randomisation de lordre des sites au sein dun mésocosme. Sonde à proximité de la mangeoire. Nous avions également une seule journée pour effectuer lensemble des acquistions, ce qui a été juste suffisant. Nous navons pas pu effectuer de répétition sur un même échantillon ce qui aurait augmenté la puissance statistique de lexpérience. Lanalyse des data a été effectuée par le post-doc en charge de lexpérience. Je nai pas de retour sur des potentiels contaminations intra et inter échantillons. Bien que la réalisation de cette expérience est statistiquement discutable, elle a été réalisée en tout début de la période de stage et ma permis la réflexion sur comment intégrer mieux la planification dexpériences. 1.3.2 Caractérisation de COV de lamandier Ce travail, qui sinscrit dans la première année dun projet de thèse, effectue une analyse temporelle des COV émis par les différents organes (bourgeon, fleur, feuille, fruit) des amandiers. Cette thèse a pour cadre un projet de lutte biologique contre un insecte ravageur des vergers damandiers. Les expériences ont durée trois mois à partir de début février. Jai aidé à la mise en place des expériences, puis jai formé la doctorante à lutilisation de linstrument. Une fois cette dernière autonome avec linstrument, jai peu assisté au suivi de lexpérience. Jai toutefois soumis lidée de suivre le moment spécifique de la floraison avec le PTR-ToF-MS. Nous avons suivi durant un week-end les COVs émis par un bourgeon que nous avons isolé du reste de la plante. Ce bourgeon avait été sélectionné car il était proche de la floraison. Ainsi, nous avons pu recueillir les odeurs émises avant, pendant et après le débourrage. Cependant, nous navons pu obtenir quune seule unité expérimentale pour cette expérience. Par ailleurs, nous avions filmé le bourgeons durant lexpérience mais la caméra sest éteinte après quelques heures. Ainsi, nous navons pas de témoin validant lheure de phénomène. Les données techniques et les résultats de lanalyse sont détaillés à la section 3.3.2. Nous retenterons probablement cette expérience en février 2022 sur plusieurs unités expérimentales, en privilégiant une série de photos plutôt quun film. Cette expérience de suivi cinétique a permis de mettre en avant les capacités de lappareil et a fait germer plusieurs idées. Par exemple, nous avons fait des réunions préparatoires pour mettre en uvre lune delles que nous allons réaliser à lautomne. Nous souhaitons analyser la réponse chimique dune fleur après la diffusion du son de bourdon, qui est un pollinisateur de cette plante. Une plante ne possède pas dorgane auditif au sens anthropologique du terme mais un son est une vibration caractérisée par des fréquences qui peuvent activer leurs sensilles mecanosensibles. 1.3.3 Étude de lémission journalière des lavandes et des figuiers Lexpérience sur les lavandes présentée ici sinscrit dans un cadre plus vaste sintéressant aux phénomènes de pollution à lOzone O3 liés au changement climatique global. Je ne reviendrai pas dans ce rapport sur la partie ozonée. Cependant, nous nous sommes intéressés aux variations journalières dans des conditions non ozonées (plantes témoins). Nous avons mis en place quatre chambres de mesure permettant chacune soit disoler un plant de lavande soit dêtre un blanc. Ces chambres de mesure sont des cylindres en plastique, ventilés, de volumes équivalents et reliés à un flux dair zéro dun débit de 5 litres/min. La longueur et le volume des lignes reliant les chambres à linstrument de mesure nétaient pas identique. Nous avons lancé des acquisitions sur les quatre chambres séquentiellement durant 48h. Nous avons répété ce processus deux fois, pour obtenir neuf plants au total dans notre plan dexpérience. Pour les lavandes, il ny avait quune modalité (plante témoin). Toutefois, un des quatre moteurs permettant la ventilation à lintérieur de la chambre ne fonctionnait pas. Nous avons décidé que cette chambre serait le blanc. Là encore, cette décision est critiquable. Dun côté, il fallait que le moteur HS soit celui de la chambre blanc afin de ne pas créer artificiellement les modalités plante témoin ventilée et plante témoin non-ventilée. Dun autre côté, nous comparons un blanc non-ventilé à des plantes ventilées. Au regard de débit dair pure de 5L/min, nous avons jugé ce biais négligeable. En revanche, nous aurions pu, au prix de quelques branchements et rebranchements supplémentaires, déplacer le moteur défectueux dune chambre à lautre entre les répétitions. Ceci aurait permis de mieux répartir lerreur expérimentale due aux lignes de mesure. Ceci étant, les résultats présentés dans la section 3.3.3 montrent que le soucis technique na pas engendré de biais notable/significatif. Quelques jours après lexpérience avec les lavandes, nous avons réutilisé le même dispositif avec des figuiers. Le temps danalyse a été augmenté pour passer à 5 jours. La chambre blanc est restée la même (non ventilée). Cette fois, les plantes étaient soit pollinisées soit non-pollinisées (témoin). Nous avons décalé la plante témoin dune chambre à lautre à chaque répétition. Théorique, la réalisation dun plan dexpérience en randomisation total aurait nécessité un tirage au sort à chaque répétition, au risque de tomber trois fois sur la même chambre. Je nai encore pas aidé à lanalyse de cette expérience et ne peut pas me prononcer sur la pertinence des choix effectués. Deux des quatre expériences présentées ici ne seront pas analysées plus en détail dans ce rapport. Pour autant, leur présentation me semblait pertinentes pour mettre en avant les difficultés à coller à la théorie des plans dexpériences dune part et pour mieux comprendre les multiples capacités de linstrument PTR-ToF-MS. 1.4 Conclusion partielle Jai commencé ce métier en novembre 2019. En raison des conditions sanitaires et de la formation continue en M2 SSV, jai une vision légèrement biaisée dune année standard sur ce poste. Pour autant, je pense avoir trouvé le bon équilibre entre dun côté le développement doutils numériques résolument orientés utilisateurs et qui entrent dans le Deuxième Plan national pour la science ouverte et de lautre côté laccompagnement des utilisateurs de la conception de leurs expériences à lacquisition. Le temps annuel consacré à chacune de ces facettes est plutôt équilibré bien que les saisons chaudes soient bien évidemment plutôt dédiées au terrain. Après ces quelques descriptions dexpériences, je propose une description plus détaillée de linstrument PTR-ToF-MS et de son environnement dans le champs de la spectroscopie de masse, chapitre 2, mais un lecteur pressé de connaître les conclusions de ces expériences peut sauter au chapitre 3. References "],["chap2.html", "2 Présentation de la PTR-ToF-MS 2.1 Une brève histoire de la PTR-ToF-MS 2.2 Instrumentation générale 2.3 Présentation des spectres 2.4 Technique rivale ou alliée de la GC-MS ? 2.5 package proVOC", " 2 Présentation de la PTR-ToF-MS De très nombreux projets de recherche issus du CeMEB nécessitent lanalyse de Composés Organiques Volatils (COV ou VOC en anglais) aussi communément appelés odeurs. Les COVs sont omniprésents dans la nature et permettent, avec les autres sens, une organisation du vivant en agissant comme vecteur dinformation de la médiation chimique. Par lacquisition dun PTR-ToF-MS, la communauté souhaitait lever trois verrous techniques : lappareil permet un fonctionnement en flux continu avec une résolution temporelle très fine (fréquence danalyse allant jusquà 10 scans par seconde), permettant ainsi le suivi des cinétiques démissions de COV. Cet instrument simplifie drastiquement et affine les expériences cinétiques effectuées par des mesures moyennées de GC-MS; le PTR-ToF-MS possède une excellente résolution en masse qui facilite lidentification des molécules. Un spectre est composé de plus de 140 000 mesures de masses couvrant une large gamme des masses des COV biologiques (de 70 à 500 m/z). Lappareil possède donc une résolution environ mille fois supérieure par rapport à un simple quadripôle (PTR-MS) qui fournit des m/z à lunité de masse atomique (uma ou Dalton Da); le seuil de détection extrêmement bas, de lordre du ppt (part per trillion), permet une sensibilité adaptée à la mesure de traces. 2.1 Une brève histoire de la PTR-ToF-MS Durant la décennie 1990, lInstitut für Ionenphysik der Leopold-Franzens-Universität dInnsbruck en Autriche développe un nouvel instrument pour lanalyse chimique des gaz. En travaillant avec la Universitiitsklinik fiir Innere Medizin, léquipe menée par Lindinger développe un spectromètre en phase gazeuse qui ionise les molécules grâce à un gaz neutre ((W. Lindinger, Leiter, et Andriollo 1991) et (W. Lindinger, Hirber, et Paretzke 1993)). Ils comprennent rapidement lavantage dutiliser un proton (apporté à la réaction sous la forme H3O+) par rapport aux ions Kr+ et Xe+. Ils publient une sorte de preuve de concept en 1994 (Lagg et al. 1994) et détaillent plus finement linstrumentation et les réactions chimiques (Hansel et al. 1995)8. En 1998 sort larticle qui fait désormais référence, (W. Lindinger, Hansel, et Jordan 1998), signé par le trio Lindinger, Hansel et Jordan (et sa version courte (W. Lindinger et Jordan 1998)). Ionicon commercialise la même année le premier PTR-MS. Cette technique se déploie rapidement dans les sciences de latmosphère, médicales et biotech ((Babcock et Adams 2001)) permettant la détection de traces de COV. Rapide et sensible, la PTR-MS élimine certains désavantages de la GC-MS. Cependant, la PTR-MS détecte de la masse nominale des ions. Un échantillon complexe peut contenir plusieurs ions isobares9. Il convient alors de gagner en résolution de masse et séparer ces isobares. (Jordan et al. 2009) revient sur les tentatives les plus concluantes ((Blake et al. 2004), (Ennis et al. 2005), (Inomata et al. 2006) et (Tanimoto et al. 2007) ) avant de proposer son approche : la PTR-ToF-MS. Développé en collaboration avec la précédente équipe, le minutieux article de (Graus, Müller, et Hansel 2010) conclu superbement la vingtaine dannées de développement nécessaire à cette technique. Les années suivantes permettront simplement une amélioration des différentes parties de linstrument. Par ailleurs, cest au tour des mathématiciens dapporter leur contribution et en particulier à léquipe de Cappellin avec deux articles. Le premier, (Cappellin et al. 2010), permet de mieux estimer la masse exacte de chaque ion détecté. Le seconde, (Cappellin et al. 2011), offre une méthodologie détaillée de lutilisation du PTR-ToF-MS de lacquisition à la fin de lanalyse. Puis en 2015, (Holzinger 2015) propose un logiciel pour lanalyse des data mais cette tentative na pas été suivie par la communauté dutilisateur. Il existe désormais un nombre important darticles utilisant la PTR-ToF-MS. Bien entendu, des outils communs de chimiométrie ont été utilisés pour renforcer les résultats, (Deuscher et al. 2019). Mais cela sera abordé dans le chapitre suivant. Je suppose que la prochaine avancée majeure viendra dune technologie permettant de discriminer les isomères10 (Claflin et al. 2021).11 Par exemple, cela permettrait de séparer les différents monoterpènes omniprésents dans les émissions végétales et qui nous concernent particulièrement en écologie chimique. Actuellement, ce désavantage est comblé par le couplage de la PTR-ToF-MS avec une seconde technique danalyse chimique. Ce court historique montre toutefois que la collaboration entre physiciens, chimistes, biologistes et mathématiciens est fructueuse et promise à un bel avenir. 2.2 Instrumentation générale Comme nous lavons vu précédemment, le PTR-ToF-MS est conçu pour analyser finement la masse moléculaire des échantillons. Pour cela linstrument aspire un débit dair constant de 100 ml/min12. Cet air in sur la figure ?? peut être connecté à un gaz zéro pour diluer un échantillon trop concentré (pour éviter la saturation) ou à un gaz étalon pour létalonnage de linstrument. Le flux dair est ensuite injecté dans le réacteur (FIMR pour focusing ion-molecule reactor). Dans cette chambre, des ions H+ issus deau ultra pure sont également injectés à débit constant afin dioniser les molécules de léchantillons (Proton-Transfer-Reaction). Schéma de la chambre dionisation (Reprinted with permission from Krechmer et al. (2018). Copyright 2021 American Chemical Society.) Il est important de comprendre que, contrairement à une ionisation par électron13, il ny a quasiment pas de fragmentation moléculaire. Cest une ionisation douce, comme en ESI fréquemment utilisée en LC-MS. En revanche les ions ont une unité de masse molaire de plus(un proton) que les molécules initiales. Par exemple, le linalol, un COV fortement produit par la lavande, a une masse molaire de 154,249 g/mol mais sera detecté à 155,256 g/mol. Par ailleurs, le nombre dions MH+ détecté dépend du taux de protonation de la molécule M. Sous forme dions, léchantillon peut être focalisé par un champ électromagnétique généré par un quadripole et envoyé dans la partie ToF. Une fois dans la colonne, lénergie potentielle dun pulse électromagnétique à 25kHz est convertie en énergie cinétique par les ions propulsés. À énergie constante, la masse fait la différence lors de la mesure du temps de vol (ToF, figure ??). Ainsi les ions les moins lourds arrivent en premiers sur le détecteur. Le comptage du nombre de coups sur le détecteur donne lintensité par unité de temps. Après étalonnage, une conversion temps de vol en masse permet de connaître lintensité de chaque masse dun échantillon. Schéma de la colonne ToF et du détecteur MS (Reproduit de larticle Graus, Müller, et Hansel (2010), consulatable ici : https://www.sciencedirect.com/science/article/pii/S1044030510001005#fig1 Pour une compréhension plus exhaustive, je recommande la lecture des articles de Hansel et al. (1995) pour la partie PTR-MS, de Graus, Müller, et Hansel (2010) pour la partie ToF et de Krechmer et al. (2018) spécifique à linstrument utilisé au CEFE. 2.3 Présentation des spectres Spectres de masse de trois lavandes acquis à 8h le 29 juin. Nous pouvons à présent nous intéresser aux spectres à analyser. Jai représenté sur la figure ?? un spectre de trois plants de lavandes acquis autour de 8h du matin fin juin. Une figure identique mais dynamique peut se télécharger ici14. Cette figure dynamique permet deffectuer des zooms afin davoir une compréhension plus précise quavec la simple figure ??. Les pics sont extrêmement fins et centrés sur les masses exactes des ions. Les pics issus des ions isotopes se regroupent autour des masses unitaires, soumis à une loi central limite locale. Cela sexplique facilement au regard de la masse exacte des atomes composants les COV (H, C, O pour lessentiel) sur le tableau de Mendeleiev15. Il y a plusieurs ordres de grandeur16 entre les pics très intenses et ceux faibles. Cette intensité ne présage rien quand à limportance de ce pic dans lanalyse. La plage spectral de linstrument est de 70 à 500 g/mol. Cela est limité pour des raisons techniques alors quil y a de nombreuses molécules dintérêts de masses inférieures à 70g/mol. En revanche la limite fixée pour les molécules volatiles et de 300 g/mol. Ces considérations prises en compte, nous obtenons pour chaque spectre un vecteur brute de 158 768 points. Ces spectres sont réduits, après alignement (voir section 2.5.1 et 3.1 ) à une taille inférieure à 50 000 points tout en gardant une résolution de 10-3 g/mol. De plus, la PTR-ToF-MS a été développée afin danalyser des cinétiques démissions. Dans nos cas, nous enregistrons des spectres de quelques secondes consécutivement durant plusieurs minutes à plusieurs jours. Pour une expérience, nous générons ainsi des dizaines, voir des milliers, de spectres. Ceci étant, nous pouvons dès à présent percevoir les problèmes liés aux temps de calculs que nous allons rencontrer et la nécessité de développer des outils optimisés pour analyser de tels objets. 2.4 Technique rivale ou alliée de la GC-MS ? La métabolomique est le maillon le plus exhaustif de la chaîne -omic. Il se concentre sur lanalyse des petites molécules, les métabolites, produites par un système biologique. Les deux domaines danalyse sont la résonance magnétique nucléaire (NMR) et la spectroscopie de masse (MS). Pour lanalyse des COV en spectrométrie de masse en écologie chimique, la technique de GC-MS est la plus utilisée à lheure actuelle. La GC-MS, utilisée depuis des décennies, est largement implantée dans le paysage scientifique international. De plus, de nombreux logiciels performants17 existent. Il est légitime de se poser la question de la nécessité dutilisation des deux techniques18. Premièrement, la GC-MS accumule les COV dans des pièges chimiques19 puis les analyses dans un second temps. La durée daccumulation dans le piège est de lordre de la dizaine de minutes jusquà 24h. La PTR-ToF-MS a une sensibilité accrue permettant lacquisition de spectres à une cadence de 25kHz. Afin daugmenter le ratio signal sur bruit et de drastiquement réduire la quantité de data générée, ces spectres sont additionnés les uns aux autres sur des durées dacquisitions plus longues20. En répétant ces acquisitions, la PTR-ToF-MS permet lanalyse cinétique dun phénomène grâce à un pas de temps daccumulation très court. Analyse statique contre analyse quasi-dynamique. Le prix de cette sensibilité est comme bien souvent une sélectivité dégradée. Ainsi la GC-MS, a contrario de la PTR-ToF-MS, peut discriminer certains isomères. Cela est permis grâce à la fragmentation des molécules lors de létape dionisation par un électron qui intervient après la phase de chromatographie. Bien que les molécules analysées soient les mêmes, les approches et résultats sont donc bien différents. De plus, il est souvent intelligent de croiser ces deux techniques (Majchrzak et al. 2018). De façon empirique, le PTR-ToF-MS analyse séquentiellement plusieurs échantillons. Il est aisé de collecté les COV pour le GC-MS juste avant ou après une séquence dédiée au PTR-ToF-MS. Nous pouvons ainsi, par exemple, obtenir deux ou trois analyses ponctuelles de GC-MS lors dune journée entière danalyse PTR-ToF-MS. Nous combinons la sensibilité et la spécificité des deux techniques. Les données obtenues en GC-MS sont donc plus complexes quen PTR-ToF-MS. Chaque échantillon est représenté par une matrice ayant une dimension pour le temps de rétention et une dimension pour le spectre de masse. Il nest donc pas possible de réutiliser tels quels les outils numériques de la GC-MS. Cependant, il serait dommage de ne pas piquer les idées déjà existantes. Jai donc créée un package R spécifique à lanalyse des données du PTR-ToF-MS mais en minspirant largement de ce qui se fait sur dautres techniques : workflow (idée piquée à MZmine), bucketing (pratique courante dans la RMN), chimiométrie (largement utilisée pour lanalyse des spectres optiques) ; ou en utilisant des packages destinés à dautres méthodes (MALDIquant conçu pour le traitement des spectres MALDI-ToF) 2.5 package proVOC Comme expliqué dans la section sur la science ouverte ( 1.2), ce package peut se retrouver sur ce dépôt Git. 2.5.1 Explication générale Lobjectif de proVOC est de permettre une vue densemble rapide21 pour les utilisateurs pressés danalyser leurs données sous R sans avoir besoin dune grande connaissance de ce langage. La fonction import_sp() constitue la première étape de lanalyse. Les données contenues dans des fichiers au format hdf5 générés par notre instrument sont importées dans lespace de travail (Fischer et al. 2021). Après cette étape, les spectres sont automatiquement alignés puis réduits. Les détails à propos de lalignement des spectres sont donnés dans la section 3.1. Pour létape de réduction, jai défini empiriquement de supprimer chaque colonne (masse) qui ne possédait aucune ligne (intensité) supérieure à un seuil. Ce seuil est calculé pour chaque jeu de données comme égal à 20 fois lécart-type médian de chaque masse22. Il est probable que cette étape de réduction peut être optimisée davantage mais je reviens sur les perspectives daméliorations du package dans la section dédiée, 2.5.4. Passé ces étapes, la fonction met en forme les données dans un objet list, récupère les metadata (date et heure dacquisition) puis détecte les pics grâce à la fonction detectPeaks() du package MALDIquant et calcule les Area Under the Curve(AUC) grâce à la function AUC() du package DescTools. Enfin, cette liste nommée sp est sauvegardée en .Rdata. Ce travail préliminaire peut être long. Une fois effectué, limport permet à lutilisateur de lancer facilement une série danalyse pour explorer rapidement son jeu de données. Pour cela, il lui suffit de modifier des options dans un workflow : # Workflow pour l&#39;analyse : mt &lt;- list(&quot;h5&quot; = mt_h5, # Don&#39;t touch &quot;acq&quot; = which(mt_h5$use4analysis == TRUE), # Don&#39;t touch &quot;wd&quot; = sp$h5$wd, # Don&#39;t touch #__________________________________# [] # graphe pour visualiser les spectres de masses de chaque acquisition : &quot;view_plot&quot; = FALSE, # Si TRUE, graphe moyen de chaque acquisition, # sinon precisez le numero d&#39;une ou plusieurs # acquistion(s). (ex : # c(200,300,400) # mt_h5$end # c(mt_h5$start, mt_h5$end) &quot;view_each.group&quot; = FALSE, # FALSE ou le nom d&#39;une meta colonne # (&quot;XXX&quot; de mt_h5$XXX) pour les graphes # larges ou centres sur un seul pic. &quot;view_plot_xmin&quot; = 70, &quot;view_plot_xmax&quot; = 250, # ou ... &quot;view_plot_peak&quot; = FALSE, # c(59,73,81,93,109,127,137,143,153) ou # False ou c(61,...) Permet de ne regarder # qu&#39;un seul pic #__________________________________# [] # ICA &quot;ICA&quot; = FALSE, &quot;ICA_AUC&quot; = TRUE, &quot;nc&quot; = 6 #__________________________________# ) PTR_MS_analysis(sp, mt) # debute les analyses Lobjet mt peut être sauvegardé pour se souvenir des paramètres utilisés lors de lanalyse. Nous pouvons détailler ci-dessous quelques options. 2.5.2 Analyse AUC #__________________________________# # Aire sous la courbe (AUC) : &quot;AUC&quot; = TRUE, &quot;AUC_plot_exp&quot; = FALSE, # Si TRUE, l&#39;axe &#39;y&#39; est exponentionnelle. &quot;AUC_each.group&quot; = FALSE, # Si l&#39;argument est le nom d&#39;une meta colonne # ( &quot;XXX&quot; de mt_h5$XXX) chaque groupe de cette # colonne aura son graphe. Sinon FALSE. &quot;AUC_each.Mass&quot; = TRUE, # Si TRUE, un graphe pour chaque masse &quot;M.num&quot; = c(81, 137, 153), # Les masses analysees (utilise pour AUC) &quot;AUC_plot_dy&quot; = TRUE, # Si FALSE, plot exporter en .tiff. Si TRUE, plot # exporter en .html (dynamique) &quot;AUC_format&quot; = &quot;date&quot;, # L&#39;axe du graphe est base sur une duree (&quot;time&quot;) # ou sur la date et heure d&#39;acquisition (&quot;date&quot;) #__________________________________# Cinétique démission des AUC à 137 Da de trois figuiers. La figure ?? montre lévolution quotidienne de lémission des molécules de masse 137 (de 136.5 à 137.5) de trois plants de figuiers dont le cadre expérimental est décrit section 1.3.3. Chaque plante est analysée par cycle de 384 secondes composé de 24 acquisitions de 16 secondes (regroupées en trois parties pour des raisons techniques). Vous pouvez télécharger cette figure ici afin de zoomer plus facilement. Nous pouvons observer que le début de chaque cycle denregistrement est systématiquement impacté par la mesure précédente et le volume mort des lignes de mesures. Nous pouvons justifier ce biais expérimental et donc le supprimer en ne prenant pas les 8 premières acquisitions de chaque cycle. Ce bloc doptions est vraiment très simple dutilisation. En jouant sur les masses et les modalités incluses dans le graphe, les utilisateurs arrivent facilement à appréhender lévolution des COV de leur système. Pour autant, nous reviendrons en 2.5.4 sur lutilisation de lAUC et sa méthode de calcul qui impact grandement ce module. 2.5.3 Étalonnage, régression linéaire et rapport automatisé #__________________________________# # Calibration &quot;calibration&quot; = FALSE, &quot;cal_rapport&quot; = TRUE, # Redige un rapport automatise pour evaluer la qualite de la calibration &quot;cal_plot_exp&quot; = TRUE, # Les axes x et y sont exponentielles ? &quot;M.conc&quot; = c(1.008, 1.018, 1.013, 1.014, 1.013, 1.013, 1.015, 1.006, 1.007, 0.994, 1.013), # La concentration, en ppm, de chaque masse, # par defaut C = 1.000 ppm. (1 ou FALSE) #__________________________________# Afin de vérifier létalonnage de lappareil, jutilise un gaz étalon que je dilue avec un gaz zéro lors des mesures. Jai développé un script pour analyser cet étalonnage. La sortie de ce script se fait sous forme de rapports automatisés basés sur des régressions linéaires simples. Jai eu pour projet de développer cela en combinant les différentes masses et en proposant des tests de validation. La base de ce script peut également être reprise pour mesurer la concentration de différentes molécules. Ceci étant, le manque de temps et le côté monovariable ont largement freiné ce projet. Dautant que nous allons le voir, le travail ne manque pas. 2.5.4 Perspectives Dans cette partie, je nai pas développé les analyses plus poussées (alignement et chimiométrie) qui sont expliquées dans le chapitre suivant. Nous avons simplement vu le principe de base de la PTR-ToF-MS ainsi que les modules de base de lanalyse : obtenir le graphe des spectres de masses, le suivi des AUC et le calcul de concentration. Le package proVOC permet deffectuer ces opérations de façon simple et sans rien coder. De plus, il met à disposition les jeux de données pour que les utilisateurs puissent soit appliquer leur propre traitement soit utiliser des modules avancés. Le package a été conçu pour assurer une reproductibilité des analyses. Lors de la conception de la structure du package, nous avions peu de recul sur lutilisation du PTR-ToF-MS. Désormais, je suis convaincu quil me faut développer la version 2 très prochainement. Trois grosses modifications vont être effectuées. La première est assez technique et concerne limportation de données : # Data importation and reduction #### f_h5 &lt;- dir(&quot;h5&quot;) %&gt;% grep(&quot;.h5&quot;, .) # localise h5 files ls_h5 &lt;- vector(&quot;list&quot;, length(f_h5)) # the acquisitions listes names(ls_h5) &lt;- nm_ls(f_h5) # and the name for (i in 1:length(ls_h5)) { ls_h5[[i]] &lt;- paste0(&quot;h5/&quot;, dir(&quot;h5&quot;)[f_h5[i]]) %&gt;% H5Fopen() # files import } mt_h5 &lt;- meta_h5(ls_h5) # make the meta file sp &lt;- sp_red(ls_h5, mt_h5) # spectra reduction sp$h5 &lt;- list(f_h5 = f_h5, ls_h5 = ls_h5, mt_h5 = mt_h5, wd = getwd()) h5closeAll() # close the connexion with the h5 files. # ls_h5 become NULL Les fonctions H5open() et H5close() du package rhdf5 permettent douvrir les formats hdf5 afin de les importer puis de les fermer. La fonction sp_red(), que jai écrite, est une meta fonction qui permet dimporter les spectres, les meta data, daligner les spectres, de supprimer les données inutiles et des détecter les peaks. Comme nous pouvons le voir, elle se trouve en sandwich entre louverture de toutes les datas et la fermeture des données. Cette maladresse occupe de la RAM inutilement et ralentie beaucoup cette étape. Pour autant, toucher à la fonction qui importe les données et les met en forme est une opération risquée qui met en péril la fonctionnalité des fonctions ultérieures. La seconde modification sera sur le calcul de lAUC. Initialement, je voulais trouver un moyen simple dexprimer les 50 000 points des spectres en une valeur plus acceptable pour de lanalyse chimiométrique. Javais donc piqué lidée du bucketing des communautés de RMN en calculant lAUC par masse unitaire (de M-0.5 à M+0.5). Cela permet dobtenir une matrice de seulement 400 colonnes environ. En réalité, cela masque les cinétiques des molécules isobares qui est un des points forts de la technique PTR-ToF-MS. De plus, jai découvert après coup une fonction très performante pour détecter les pics (2.5.1). Je peux donc remplacer les AUC unitaires par lintensité des pics. Il ny aura alors plus quune confusion sur les isomères mais qui correspond aux limites techniques de linstrument. Jaimerais également travailler sur lAUC des pics et leur déconvolution afin de savoir si de linformation y est cachée. La dernière modification se fera sur la structure : PTR_MS_analysis(sp, mt) # debute les analyses Une seule fonction permet de lancer la série danalyses précisée dans le workflow mt sur les data de lélément sp. La fonction PTR_MS_analysis() ne retourne rien, si ce nest des graphiques, des fichiers .csv ou des rapports automatiques. Jaimerais inclure le workflow à lintérieur de lobjet sp et le compléter au fur et à mesure. Ainsi lutilisateur pourrait lancer des opérations à la volée, par exemple (en reprenant le bloc AUC de la section 2.5.2) : # Aire sous la courbe (AUC) : sp &lt;- sp_AUC(sp, AUC_plot_exp = FALSE, AUC_each.group = FALSE, AUC_each.Mass = TRUE, M.num = c(81, 137, 153), AUC_plot_dy = TRUE, AUC_format = &quot;date&quot;) Cette forme franchement plus digeste permettra dinclure plus simplement une analyse PTR-ToF-MS dans un script ou un rapport Rmarkdown. Jespère, avec ces modifications importantes, rendre lanalyse plus optimisée en temps et répondre mieux aux attentes des utilisateurs. Ce package est sur GitHub depuis septembre 2020. Jai fait peu de pub car je connais ses limites et je souhaiterais corriger ses principaux défauts avant de le proposer aux collègues des autres centres de recherche avec qui nous avons des contacts. Les retours sur les quelques démonstrations effectuées sont très positives et proVOC permettra (je lespère) de répondre positivement à un réel besoin. De plus proVOC est complètement cohérent avec les principes de lopen science développés au chapitre 1 et intègre des analyses chimiométriques qui sont détaillées au chapitre 3. References "],["chap3.html", "3 Méthodes Multivariées 3.1 Alignement et sélection de variables 3.2 Analyses Chimiométriques 3.3 Applications 3.4 Discussions", " 3 Méthodes Multivariées Nous allons à présent nous intéresser aux algorithmes utilisés pour traiter les jeux de données générés par le PTR-ToF-MS. Ce chapitre est divisé en deux parties. Lors de lécriture du package, javais travaillé sur différentes méthodes dalignement avant de marrêter sur lune delle. Le début de ce stage ma permis de reprendre ce travail avec des idées nouvelles que je présenterais dans une première partie. La deuxième partie présente lutilisation de la chimiométrie pour lanalyse de donnée, dabords avec la PCA puis avec deux méthodes moins connues, lICA et la MCR qui ont lavantage chacune dessayer de décomposer les données en produits pures. 3.1 Alignement et sélection de variables Actuellement, le package utilise la fonction alignSpectra() du package MALDIquant. Lalignement est fortement lié à la détection de pic. Soit le modèle utilisé nest pas optimum et ajoute ou supprime des pics. Soit il crée un décalage trop important en alignant mal les pics ce qui génére de la confusion lors de létape didentification. alignSpectra() est performant mais rencontre des limites sur les pics de faible ratio signal sur bruit, comme nous pouvons le voir sur la figure ??. Le bruit intensifie leffet vaguelette et génère de lambiguïté sur le nombre de pics présent. Par ailleurs, la fonction créé des pics négatifs qui faussent le calcul de lAUC. Zoom sur une série de pics très peu intenses émis par les lavandes. Des vaguelletes et des pics négatifs apparaissent. Jai trouvé un article très intéressant de Picaud et al. (2018) qui propose un algorithme pour supprimer la ligne de base, aligner les pics et les détecter. Larticle explique les problèmes de faire ces trois étapes successivement et propose donc une alternative. Nous avons discuté avec lauteur de sa solution. Malheureusement, le script est écrit en C++. Il est possible dutiliser ce langage sous R, via Rcpp par exemple, mais cela aurait demandé un peu trop de temps. Pour linstant, cette solution a été mise de côté mais pourra être explorée plus tard. De plus, Jean-Michel Roger ma proposé une approche basée sur lalgorithme COVSEL (Roger et al. 2011) pour résoudre notre problème. Cette méthode permet de recaler les masses en recalculant labscisse pour chaque spectre. On observe cependant dans la théorie (équations 4 et 5) que lon va devoir diagonaliser une matrice denviron 150000x150000 points, essentiellement composée de zéro. Cette opération est impossible a effectué avec un ordinateur de bureau. Pour autant, la solution que jai trouvé est dutiliser lalgorithme COVSEL sur une toute petite partie du spectre et de le faire glisser sur toute la longueur. Cette technique fonctionne mais nest pas du tout optimisée et prend un temps non acceptable (environ une minute par spectre). Finalement, nous avons fait le choix de garder la fonction alignSpectra() de MALDIquant. De plus, ce package nous permet davoir une liste de tous les pics détectés. Ainsi, nous avons pour un même jeu de donnée, trois matrices à utiliser pour les analyses chimiométriques : la matrice alignée (composée denviron 50 000 masses) ; (Mc) les AUC (~340 masses unitaires non nulles) ; (Ma) les pics (~300 pics, qui peuvent être des isobares). (Mp) Pour une étude chimiométrique, nous pouvons discuter de la pertinence des jeux de données. Avec une matrice alignée Mc, on peut estimer que les algorithmes puissants des chimiomètriciens vont détecter de petites variations négligées par les méthodes de détection de pics. Les Mc peuvent donc détecter les traces de COV. Cependant les deux autres matrices Ma et Mp (AUC ou pics) possèdent un nombre de colonnes réduit de presque deux ordres de grandeur. De plus, le grand avantage du PTR-ToF-MS est dobtenir des spectres ayant une excellente résolution de masse (10-3Dalton). Nous pouvons donc utiliser les matrices Ma et Mp pour les analyses chimiométriques avec une préférence pour les secondes. Maintenant que les outils pour détecter les pics et les outils danalyses sont fonctionnelles pour les jeu de données du PTR-ToF-MS, il serait très intéressant danalyser (via une MCR par exemple) comment la modification des paramètres de la fonction detectPeaks() (de MALDIquant) influe sur les résultats de chimiométrie. 3.2 Analyses Chimiométriques 3.2.1 Analyse en Composante Principale (ACP) LACP23 est une méthode bien connue et enseignée dans toutes les formations danalyses statistiques. Elle permet dobtenir rapidement une vision de la variance des données. ProVOC permet deffectuer une ACP sur le jeu de donnée de lutilisateur. Un exemplaire peut être consulté ici. Il décrit le jeu de donnée utilisé dans la section 1.3.3 et y sera commenté dans cette même section. LACP peut être appliqué à la matrice alignée avec un temps de calcul acceptable. Cependant, le résultat de lACP est un pur objet mathématique qui est souvent très compliqué à interpréter correctement. Je me suis donc intéressé à deux algorithmes que je souhaitais utilisé depuis longtemps24. 3.2.2 Multivariate Curve Resolution (MCR) Bilinear model obtained from MCR for an HPLC-DAD data set. Expressed as (a) sum of pure signal contributions; (b) sum of the dyads of pure concentration profile and spectra; and (c) product of matrices of pure concentration profiles and spectra. (Image reproduit de Anna de Juan, Jaumot, et Tauler (2014) avec lautorisation de léditeur.) La MCR est une famille de méthodes qui cherche à décomposer lensemble des spectres en plusieurs sous-ensembles de produits pures. La figure ?? issue de larticle de Anna de Juan, Jaumot, et Tauler (2014) permet de bien comprendre lobjectif dune MCR. La matrice D, obtenue par lexpérience, est lexpression de deux produits pures SAT et SBT (deux bouquets de COV pour notre PTR-ToF-MS) de concentration CA et CB, qui sont les quatre vecteurs que nous cherchons à connaître25. Les étapes de léquation sont décrites dans larticle précédemment citée. De plus, la MCR permet lajout de contraintes telles que la non-négativité qui permet de ne pas avoir de composantes négatives dans les SiT (fréquent en ACP) ou la contrainte dégalité qui permet par exemple de renseigner un spectre pure de référence. Un autre aspect très important de la MCR est de comprendre les trois ambigüités liées à lalgorithme : lambigüité de permutation. Il ny a pas dordre dans les spectres pures et leure concentration associée. Le spectre SiT ne représente pas plus ou moins lensemble du jeu de donnée que le spectre SjT. lambigüité dintensité. Lintensité du spectre pur Si et sa concentration Ci peuvent être multipliées conjointement par les facteurs ki et ki-1. La MCR ne peut donner quune concentration relative. lambigüité de rotation. Il est possible dintroduire une matrice inversible R dans les équations : \\[D = CS^T + E\\] \\[D = (CR)(R^{-1} S^T) + E\\] Puisque lalgorithme de la MCR cherche à minimiser lerreur E, la matrice R ne fait pas varier E mais change la composition des résultats. Les contraintes permettent de lever en partie ces ambigüités. La MCR permet donc dinitier les matrices C et ST. Cette opération est utilisée dans un ensemble itératif MCR-ALS (alternating least squares) qui permet doptimiser les résultats en fonction des contraintes utilisées. Par ailleurs, le nombres de composantes est un paramètre essentiel qui correspond véritablement à un nombre de phénomènes naturels. Il ne peut pas être déterminé arbitrairement à linverse du nombre de CP dans une ACP. Théoriquement, une MCR peut être effectuée avec le jeu de donnée de la matrice alignée. Cependant, avec un ordinateur de bureau, les calculs sont assez long. Un excellent complément dinformation se trouve dans le livre Ruckebusch (2016) et en particulier les chapitres 2 (A. de Juan et Tauler 2016), 3 (Kucheryavskiy, Windig, et Bogomolov 2016) et 14 (Hugelier, Devos, et Ruckebusch 2016). De plus, le chapitre 7 (Rutledge et Rimbaud Bouveresse 2016) présente lalgorithme de lICA. Ces deux algorithmes cherchent tous deux à extraire des spectres pures. Pour autant, les deux approches sont différentes et génèrent parfois des incompréhensions entre les communautés. 3.2.3 Independent Components Analysis (ICA) Lobjectif principale de lICA est de retrouver les signals sources mélangés à lintérieur du jeu de données et la proportion de chacun deux. Pour cela, lICA sinterresse à la distribution de lintensité du signal sur un histogramme (cf. Fig2 de Rutledge et Rimbaud Bouveresse (2016)). Selon la loi centrale limite, plus lhistogramme tend vers une répartition gaussienne, plus il y a de chances que ce signal soit du bruit. Inversement, moins la répartition est gaussienne, plus le signal correspond à un signal source. De plus, comme pour une ACP, lICA cherche à obtenir des signals sources indépendant, et donc orthogonaux. Contrairement à la MCR, LICA nimpose pas de contrainte. La phrase de (Rutledge et Rimbaud Bouveresse 2016) permet de bien comprendre la différence entre les deux méthodes : This is because while MCR aims to extract the signals of pure compounds, ICA extracts signals reflecting underlying independent phenomena, which may in fact be combinations of the signals of several pure compounds.26 Il existe plusieurs algorithmes itératifs qui utilisent lICA, (Wang, Ding, et Hou 2008) et (Al-Saegh 2015). Cependant, lagorithme JADE (Cardoso et Souloumiac 1993) est probablement le plus utilisé pour lICA, (Rutledge et Jouan-Rimbaud Bouveresse 2013) et (Rutledge et Jouan-Rimbaud Bouveresse 2015). Un package JADE pour R est déposé et maintenu sur le CRAN. Le principe de JADE est de décomposé la matrice X (le jeu de données expérimentales) en utilisant les loadings dune ACP. Ces loadings sont centrés et normés puis arrangés pour former un tenseur dordre 4. De façon itérative, JADE va ensuite optimiser ces loadings pour les rendre indépendants. Cette description succincte permet très vite de comprendre que réaliser un tenseur dordre 4 à base de vecteur de 55000 points risque dêtre problématique. LICA ne peut se faire que sur une matrice réduite comme lAUC ou les pics détectés dans loptique dune utilisation avec un ordinateur de bureau. 3.3 Applications Jai testé les packages alsace (Wehrens, Carvalho, et Fraser 2015), ChemometricsWithR et ALS anfin dutiliser la MCR-ALS avec R. Les packages alsace et ChemometricsWithR sont du même auteur mais le premier est encore soutenu. alsace utilise le package ALS pour le calcul et le rend compatible directement avec le format liste donné en sortie de la fonction detectPeaks(). Le package alsace applique par défaut uniquement la contrainte de non-negativité. Pour la partie ICA, jai utilisé le package rnirs27 dans le package proVOC. Ce module ICA est implémenté mais peu fonctionnel et ne travaille quavec les AUC. De plus, le package rnirs est en cours de transformation et sera bientôt soutenu par la communauté ChemHouse à laquelle je contribue modestement. Toutefois, jai échangé avec D.Rutledge qui ma envoyé un rapport en utilisant les spectres entiers de lexpérience de lavandes (cf ci-dessous). Ces résultats sont difficiles à interpréter à cause du format de présentation. Les acquisition des 12 spectres ayant été concatenées. Cependant, on remarque des formes relativement similaires à celles produites par les spectres pures de la MCR que nous allons voir par la suite. 3.3.1 Détermination du nombre de composantes Je nai pas trouvé de méthode théorique pour définir le nombre de composante. Une méthode proposée28 pour ajuster le nombre de composés est de procéder comme avec une ACP, cest à dire, déduire en fonction du pourcentage exprimé de chaque CP la séparation entre le signal et le bruit. La package alsace propose la fonction smallComps() pour aider à fixer ce nombre. Je pense quon se trouve dans la limite mathématique de lexercice et quil est bon de discuter avec le praticien. Jeffectue alors plusieurs cycles en incrémentant le nombre de composantes. En interprétant les résultats, nous arrivons à déterminer une limite entre ce qui reflète un phénomène probable et ce qui est probablement du bruit. 3.3.2 Suivi de la floraison Spectres pures de la matrice Si issues de la MCR effectuée sur les données du bourgeon. Les spectres ont été décalés de 0.25 u.a. pour une meilleure compréhension. Cette expérience est expliquée plus en détail dans la section 1.3.2. Les données ont ensuite été traitées avec proVOC puis analysées par MCR. La figure ?? représente les composés purs de lexpérience. Pour qui a lhabitude des analyses ACP, il paraît évident que linterprétation de ce genre de résultat est plus intuitive. Cinétique de la matrice des concentrations Ci issues de la MCR effectuée sur les données du bourgeon. La figure ?? permet de voir lévolution des cinq composantes au cours du week-end danalyse. Il y a deux artefacts sur ces résultats. Premièrement, nous observons des oscillations très régulières. Bien que nous nen navons pas compris la nature exacte, cela vient du système de climatisation. Secondement, nous avons effectué une mesure blanche durant 30 minutes chaque 4h. Cela se remarque très facilement, par exemple sur la composante n°2, nous pouvons voir un pic un peu avant 22h suivi dun autre un peu avant 2h du matin. Passé ces artefacts, nous pouvons interpréter les phénomènes. La composante n°2 (en bleu nuit) est monotone décroissante. Ces composés sont ceux de la pollution extérieure à notre système biologique et chassés par le flux dair zéro en quelques heures. Les composés n°5 et 4 (jaune et vert) sont ceux du bourgeons avec lalternance phase de nuit/phase de jour (levé du soleil : 07h24). La floraison a très probablement eu lieu au alentour de 14h. Nous avons deux indices qui laissent penser ça. Premièrement, les cinétiques de composés 4 et 5 sont perturbées entre 14 et 18h. Secondement, le bouquet dodeurs de la fleur damande, traduit par la composante n°3 augmente à partir de ce moment. En outre, la composante n°1 montre des phénomènes très ponctuels que nous navons pas identifiés. Ces hypothèses dinterprétation nécessitent encore une analyse fine didentification des composantes mais ces résultats ont été un moteur dintérêt à la fois pour la PTR-ToF-MS et pour la MCR-ALS. 3.3.3 Analyse de lémission journalière des lavandes Spectres pures de la matrice Si issues de la MCR effectuée sur les données des lavandes. Les spectres ont été décalés de 0.25 u.a. pour une meilleure compréhension. Cinétique de la matrice des concentrations Ci issues de la MCR effectuée sur les données des lavandes. Lexpérience est décrite dans la section 1.3.3. Pour analyser cette expérience, jai procédé de la même façon que pour lanalyse de la floraison de lamandier. Après discussion avec la doctorante expérimentatrice, nous avons conclu que cinq composantes était un nombre optimum pour interpréter les résultats. Ces composantes sont représentées sur la figure ??. Jai rendu plus visible les composantes n°2 (bleu nuit) et 4 (vert) qui sont les plus intéressantes pour notre cas. La figure ?? permet linterprétation de ces résultats. Pour faciliter la lecture, jai placé sur une même colonne les unités expérimentales enregistrées le même jour et sur une même ligne les unités expérimentales enregistrées dans une même chambre. Les lignes 1 à 4 correspondent aux chambres 1 à 4. Les colonnes 1 à 3 correspondent aux jours 1, 3 et 5. Les abréviations lv et bl désignent respectivement les unités expérimentales où se trouvent une lavande et celles servant de blanc. La composante n°1 (violet) est un artefact qui se produit principalement dans les unités blanches avec un fort pic à 11h. Quelques fluctuations se retrouvent dans les autres unités, principalement lors du jour 1. La composante n°3 (turquoise) est un bruit de fond que lon retrouve dans toutes les analyses29. La composante n°5 (jaune) est plus compliquée à interpréter. Elle se retrouve dans les unités lavandes mais pas dans les unités blanches. Une fois ces trois composantes analysées, nous pouvons nous attarder sur les composantes n°2 et 4. Les expériences ayant été effectuées en juin, jai placé deux lignes verticales pour marquer le levé (en jaune) et le couché (en bleu) du soleil. Le levé du jour est parfaitement synchronisé avec lémission des COV n°2 et 4. La composante 2 est émise durant toute la journée. La plante arrive en quelques heures à un plateau démission puis anticipe une diminution avec le déclin du jour. Il est très intéressant de comparer les profils dun même jour. Par exemple, nous observons un creux dans les trois profils du jour 1 au alentour de 15h. La composante 4 suit un profil démission différent de la composante 2. Lémission des COV arrive en 2h à un maximal puis décroit très rapidement par la suite pour retrouver une émission quasi nulle à midi. Le système circadien de la lavande est bien connu, tout comme le fait que sa production de COV dépend des facteurs extérieurs comme lensoleillement (Guitton 2010). Cependant, le résultat dune double émission au sein dune même journée na jamais, au meilleur de notre connaissance, été mis si distinctement en valeur. De plus, ce résultat se retrouve sur 9 unités expérimentales réparties en 3 jours et 3 chambres et contrôlées avec un blanc. Si lexpérience de la floraison nétait quun test, cette expérience est très concluante. 3.4 Discussions Les analyses MCR sont satisfaisantes mais nécessitent encore dêtre complétées par un travail dindexations des pics. Cela permettra de consolider dun point de vue biologique lhypothèse du double cycle démission des lavandes. De mon côté, je peux renforcer lanalyse par plusieurs façon. Dune part, nous avons vu que les rapports automatisés de lACP effectués par proVOC sont assez sommaires. Le changement de structure du package permettra dappliquer plus facilement des pré-traitements et des sélections de variables à lACP. Cet outil reste un excellent moyen dexploration à laveugle des jeu de données, notamment pour détecter les outliers. Ensuite, il reste un travail, probablement à effectuer en commun avec les membres de Chemhouse, pour optimiser les analyses MCR et ICA30 puis en croissant les résultats de lanalyses biologiques avec les spectres pures(MCR) et les signals sources(ICA) afin de définir au plus juste quel algorithme décrit le mieux les lois naturelles. References "],["conclusion.html", "4 Conclusion", " 4 Conclusion Cette période de ce stage un peu particulier sachève et ce rapport essaie de rendre compte au plus juste possible le travail effectué durant ces mois de printemps et dété. Nous avons pu voir quen amont du traitement de la data, il y a lacquisition de celle-ci et que cette tâche était au moins aussi importante. Jai passé sous silence une grosses partie des problèmes techniques rencontrés et autres pannes31. Pour autant, ces contraintes font parties du métier et lanalyste doit savoir si plier en ne maudissant que modérément lexpérimentateur, lorsque ce nest pas lui-même. Il doit être présent dans le projet dés le début et participer à lélaboration théorique de lexpérience. Il est aussi crucial de maîtriser la technique de linstrument de mesure. Par exemple, en spectroscopie optique les pics peuvent avoir un décalage en longueur dondes qui traduit un effet de contrainte sur léchantillon. Ce décalage ne peut pas exister en spectrométrie de masse, ou alors de façon discrète modulo 1,007 Da qui correspond à la masse dun proton. Une fois cela acquis et mis en uvre, les outils numériques ne manquent pas pour décortiquer les données. Je pourrais en ajouter à larsenal de proVOC, comme par exemple la PLS (et ses variantes) pour effectuer des régressions. Je me suis attardé pour linstant à la découverte de la MCR et de lICA qui sont moins connus des utilisateurs et qui, de fait, demandent un plus grand travail daccompagnement pour leur utilisation. Nous avons pu voir les avantages de telles méthodes. Avant cette année de master, je connaissais très peu de choses sur les modèles linéaires généralisés, les séries temporelles et spatiales, les plans dexpériences. Bien quil me faudra quelques contorsions du cortex pour intégrer ces connaissances théoriques obtenues à ma pratique quotidienne, je ne doute pas quelles me seront utiles dans un futur proche. À travers ce rapport, jespère avoir synthétisé correctement six mois de travaux effectués par un physicien dans un contexte à la frontière entre les mathématiques, lenvironnement et la chimie. Cette interdisciplinarité, que je recherche depuis la fin de mon master 2 de photonicien, demande un apprentissage lent mais constant et une volonté permanente de vouloir sortir de sa zone de confort. Cest avant tout un goût pour la découverte et des aventures scientifiques que je recommande à chacun. mention spéciale à la climatisation des serres, H-S plusieurs semaines à partir de mi-juillet. "],["references.html", "References", " References "]]
